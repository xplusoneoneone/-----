# 贺卡类插件 (Image Layer Plugin)

一个专为Adobe Photoshop设计的CEP扩展插件，用于自动化处理图像图层组和图片文件。

## 📋 功能特性

### 🖼️ 图片预览功能
- **文件夹选择**：支持选择包含图片的文件夹
- **图片预览**：实时预览文件夹中的所有图片文件
- **智能排序**：支持按文件名数字顺序自然排序
- **图片放大**：点击图片可全屏放大查看
- **文件信息**：显示文件名和序号

### 🎨 Photoshop集成
- **图层组识别**：自动查找指定名称的图层组
- **图片导入**：将文件夹中的图片导入到Photoshop图层组
- **路径验证**：自动验证文件夹路径和图片文件存在性
- **错误处理**：完善的错误提示和状态反馈

### 🎯 支持的图片格式
- PNG (.png)
- JPEG (.jpg, .jpeg)
- GIF (.gif)
- BMP (.bmp)
- TIFF (.tiff, .tif)
- 注意：下载图片可能无法加载至PS，原因一般是因为下载过程中有损坏，需要高清处理后才能成功加载
## 🚀 安装方法

### 前置要求
- Adobe Photoshop CC 2015 或更高版本
- 支持CEP扩展的操作系统
- 需要运行所有 `.reg` 注册表文件
### 安装步骤

1. **下载插件**
   ```bash
   # 克隆或下载插件文件到本地
   ```

2. **安装到Photoshop**
   - 将插件文件夹复制到CEP扩展目录：
     - **Windows**: `C:\Users\[用户名]\AppData\Roaming\Adobe\CEP\extensions\`（CEP和extensions需要手动创建。需要显示隐藏文件然后才能找到AppData）
     - **macOS**: `~/Library/Application Support/Adobe/CEP/extensions/`

3. **启用调试模式**（首次安装需要）
   - **Windows**: 创建注册表项或使用Adobe Extension Builder
   - **macOS**: 在终端执行：
     ```bash
     defaults write com.adobe.CSXS.11 PlayerDebugMode 1
     ```

4. **重启Photoshop**
   - 完全关闭并重新启动Adobe Photoshop

5. **加载插件**
   - 在Photoshop中：`窗口 > 扩展功能 > 图像类插件`

## 📖 使用说明

### 基本操作流程

1. **打开Photoshop文档**
   - 确保有一个打开的PSD文档
   - 文档中应包含名为"组 1"的图层组

2. **启动插件**
   - 从扩展功能菜单中打开插件面板

3. **选择图片文件夹**
   - 点击"选择文件夹"按钮
   - 或直接在输入框中输入文件夹路径

4. **预览图片**
   - 插件会自动显示文件夹中的所有图片
   - 点击图片可放大查看
   - 图片按文件名数字顺序排列

5. **执行导入**
   - 点击"编辑并继续"按钮
   - 插件会将图片导入到"组 1"图层组中

### 高级功能

#### 图片预览
- **排序方式**：支持数字自然排序（如：1, 2, 10, 11）
- **放大查看**：点击图片进入全屏模式
- **文件信息**：显示文件名和序号
- **响应式布局**：自适应不同屏幕尺寸

#### 错误处理
- **路径验证**：检查文件夹是否存在
- **文件检查**：验证文件夹中是否包含图片
- **图层组检查**：确认目标图层组是否存在
- **详细提示**：提供具体的错误信息和解决建议

## 🛠️ 技术架构


### 文件结构
```
图像类插件/
├── index.html          # 主界面
├── script.js           # 前端逻辑
├── style.css           # 样式文件
├── host/
│   └── main.jsx        # ExtendScript脚本
├── CSXS/
│   └── manifest.xml    # 插件清单
└── README.md           # 说明文档
```

## 🔧 配置说明

### 图层组名称
默认查找名为"组 1"的图层组，可在代码中修改：
```javascript
// 在script.js中修改图层组名称
csInterface.evalScript('getLayerSets("你的图层组名称", "' + imagePath + '")', ...);若后续图层组名称有修改也需要修改参数
```

### 支持的图片格式
可在`script.js`中修改支持的图片格式：
```javascript
var imageExtensions = ['.png', '.jpg', '.jpeg', '.gif', '.bmp', '.tiff', '.tif'];
```

## 🐛 故障排除

### 常见问题

1. **插件无法加载**
   - 检查CEP扩展目录路径是否正确
   - 确认已启用调试模式
   - 重启Photoshop

2. **找不到图层组**
   - 确认PSD文档中有名为"组 1"的图层组，空格也是算做字符串需要添加
   - 检查图层组名称是否包含特殊字符

3. **图片无法预览**
   - 检查图片文件是否损坏
   - 确认图片格式是否支持
   - 刷新页面重试

4. **路径错误**
   - 使用"选择文件夹"按钮而不是手动输入
   - 检查文件夹路径是否包含特殊字符
   - 确认文件夹中确实包含图片文件，确实包涵要去除图片路径，只保留文件夹路径

### 调试模式
启用调试模式可查看详细错误信息：
- 打开浏览器开发者工具
- 查看控制台输出
- 检查网络请求状态

## 📝 更新日志

### v1.0.0 (2025-08-12)
- ✨ 初始版本发布
- 🎯 基础图片预览功能
- 🔗 Photoshop图层组集成
- 🎨 现代化UI设计
- 📱 响应式布局支持

